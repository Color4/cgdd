{% load staticfiles %}
<table align="center" cellpadding="6" style="margin: 0; padding: 0px; border: 1px solid blue;">
<tr><td>
<p><b>Driver Gene: {{ driver.gene_name }}</b>  &nbsp; &nbsp; &nbsp; <u>Synonyms:</u> {{ driver.prev_names_and_synonyms_spaced }}</p>
<p><u>Gene Descripion:</u> {{ driver.full_name }}</p>
<p><u>External links:</u> {{ gene_weblinks|safe }}</p>

{% comment %}
	Now using flashbox:
	Note: ID's are single use and are only applied to one element. Galleries are created from elements who have the same "data-fancybox-group" or "rel" attribute value.   Use `title` or `data-fancybox-title` attribute to specify item caption.
    Note: The boxplot 'data-fancy-title' text needs single quotes around it, as the gene_weblinks contains double quotes.
    Need the 'safe' filter for the 'web_genelinks' otherwise django will put double quotes arround the string as assumes it is unsafe.
{% endcomment %}

For driver gene <b>{{ driver.gene_name }}</b>, a total of <b>{{ dependency_list.count }} dependencies</b> were found {% if histotype == "ALL_HISTOTYPES" %} in <b>All tissues</b> {% else %} with tissue type <b>{{ histotype_full_name }}</b> {% endif %} {% if study == "ALL_STUDIES" %} in <b>All studies</b> {% else %} in study {{ study.weblink|safe }} "{{ study.title }}", {{ study.authors|slice:":30" }} et al, {{ study.journal }}, {{ study.pub_date }} {% endif %}:<br/>
<div style="font-size: 70%;">( Use scrollbar at right of this table to scroll down. Click column header to sort by that column. Click on the gene name in the depenency column to view the box-plot. Enter text into the search box at top of column to optionally filter these results )</div>
 <!-- a href="http://www.ncbi.nlm.nih.gov/pubmed/{{ study.pmid }}" target="_blank">{{ study.pmid }}</a --> 
{% if dependency_list %}
{# <p style="font-size: 75%;">For Driver 'ERBB2': Click the 'MAP2K3' dependency to display the box plot at bottom of this table.</p> #}

{# Removed this from the link as slows dependency table download as download all boxplot images on page load: <img src="{% static 'gendep/boxplots/' %}{{ dependency.boxplot_filename }}" /><br/> #}
{# Removed links for driver from the facnybox text: <font size="-2">{ { dependency.driver.gene_name } } links: { { gene_weblinks|safe } }<br/> #}

{# data-fancybox-width="700" #}

  {# <a href="{% url 'gendep:download_tsv' driver_name=driver.gene_name histotype_name=histotype study_pmid=study %}">[Download tabbed file]</a> #}
  
  <p align="right" style="margin-top: 0; margin-bottom: 0;"><button type="button" name="Download" onClick = window.open("{% url 'gendep:download_tsv' driver_name=driver.gene_name histotype_name=histotype study_pmid=study %}")>Download as CSV file</button></p>
  
  <table id="result_table" class="tablesorter" style="font-size:80%;"> <!-- tabler  -->
  <thead>
    <tr><th>Dependency</th>
	<th class="filter-select">P-value</th>
	<th>Effect size</th><th>Study</th><th>Tissue</th><th>Inhibitors</th><th>Experiment Type</th><th><a class="tipleft">Interaction<span>Known functional interaction between {{ driver.gene_name }} and dependency gene, from string-db.org</span></a></th></tr>
  </thead>
  <tbody>
    {% for dependency in dependency_list %}
    <tr> 
        <td>
		<a class="fancybox tipright" rel="group" href="{% static 'gendep/boxplots/' %}{{ dependency.boxplot_filename }}" data-fancybox-title='<b>{{ dependency.driver.gene_name }}</b> mutant cell lines have an increased dependency upon <b>{{ dependency.target.gene_name}}</b><br/>(p={{ dependency.wilcox_p_power10_format|safe }} | Tissues={{ dependency.get_histotype_display }} | Source={{ dependency.study.weblink|safe }})<br/>{{ dependency.target.gene_name }} links: {{ dependency.target.external_links_on_boxplot|safe }}</font>' >{{ dependency.target.gene_name }} &nbsp; <font size="-2">{{ dependency.target.prev_names_and_synonyms_spaced }}</font><span>{{ dependency.target.full_name }}: {{ dependency.target.prev_names_and_synonyms_spaced }}</span></a></td>

        {# <td align="center" width="100">{  { dependency.wilcox_p|stringformat:".0E" }  }</td> #}
		
        <td align="center" width="100">{{ dependency.wilcox_p_power10_format|safe }}</td>
				
		<td align="center">{{ dependency.effect_size }}</td>
		
        <td align="center">{{ dependency.study.weblink|safe }}</td>

        <td align="center">{{ dependency.get_histotype_display }}</td>

		<td align="center"></td>  {#{ dependency.inhibitors }#}
		 
        <td><a href="#" class="tipleft">{{ dependency.study.experiment_type }}<span>{{ dependency.study.summary }}</span></a></td>
		
		<td align="center">{{ dependency.interaction }}</td>
    </tr>
    {% endfor %}
	</tbody>
  </table>
</td></tr>
</table>  
{% else %}
    <p>No dependencies found.</p>
{% endif %}

